export CUDA_VISIBLE_DEVICES=$PMIX_RANK
#starting batches of every 6 models come into this script. Each rank should do the model for base id + their rank
let modelID=$1+$PMIX_RANK

# load from 4combine sentence finetune checkpoint
jobneme=(
    'python /gpfs/wscgpfs02/chendo11/workspace/matai/fairseq_pro/utils_main.py --load_pretrain --model_name_or_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/ --checkpoint_file checkpoint_best.pt --data_name_or_path  /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/finetune_data/toxicity_combine_all_train_valid_for_sentence_fintune/ --target_file /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/test_smi_npy/LD50_train_canonical.smi --save_hidden_info_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LD50_train_hidden_info_LD50_finetune.npy --get_hidden_info --get_hidden_info_from_model --extract_features_method average_all --extract_features_from_hidden_info --save_feature_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LD50_train_x_avg_LD50_finetune.npy'
    'python /gpfs/wscgpfs02/chendo11/workspace/matai/fairseq_pro/utils_main.py --load_pretrain --model_name_or_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/ --checkpoint_file checkpoint_best.pt --data_name_or_path /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/finetune_data/toxicity_combine_all_train_valid_for_sentence_fintune/ --target_file /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/test_smi_npy/LD50_test_canonical.smi --save_hidden_info_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LD50_test_hidden_info_LD50_finetune.npy --get_hidden_info --get_hidden_info_from_model --extract_features_method average_all --extract_features_from_hidden_info --save_feature_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LD50_test_x_avg_LD50_finetune.npy'

    'python /gpfs/wscgpfs02/chendo11/workspace/matai/fairseq_pro/utils_main.py --load_pretrain --model_name_or_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/ --checkpoint_file checkpoint_best.pt --data_name_or_path /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/finetune_data/toxicity_combine_all_train_valid_for_sentence_fintune/ --target_file /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/test_smi_npy/IGC50_train_canonical.smi --save_hidden_info_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/IGC50_train_hidden_info_IGC50_finetune.npy --get_hidden_info --get_hidden_info_from_model --extract_features_method average_all --extract_features_from_hidden_info --save_feature_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/IGC50_train_x_avg_IGC50_finetune.npy'
    'python /gpfs/wscgpfs02/chendo11/workspace/matai/fairseq_pro/utils_main.py --load_pretrain --model_name_or_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/ --checkpoint_file checkpoint_best.pt --data_name_or_path /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/finetune_data/toxicity_combine_all_train_valid_for_sentence_fintune/ --target_file /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/test_smi_npy/IGC50_test_canonical.smi --save_hidden_info_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/IGC50_test_hidden_info_IGC50_finetune.npy --get_hidden_info --get_hidden_info_from_model --extract_features_method average_all --extract_features_from_hidden_info --save_feature_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/IGC50_test_x_avg_IGC50_finetune.npy'

    'python /gpfs/wscgpfs02/chendo11/workspace/matai/fairseq_pro/utils_main.py --load_pretrain --model_name_or_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/ --checkpoint_file checkpoint_best.pt --data_name_or_path /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/finetune_data/toxicity_combine_all_train_valid_for_sentence_fintune/ --target_file /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/test_smi_npy/LC50_train_canonical.smi --save_hidden_info_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LC50_train_hidden_info_LC50_finetune.npy --get_hidden_info --get_hidden_info_from_model --extract_features_method average_all --extract_features_from_hidden_info --save_feature_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LC50_train_x_avg_LC50_finetune.npy'
    'python /gpfs/wscgpfs02/chendo11/workspace/matai/fairseq_pro/utils_main.py --load_pretrain --model_name_or_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/ --checkpoint_file checkpoint_best.pt --data_name_or_path /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/finetune_data/toxicity_combine_all_train_valid_for_sentence_fintune/ --target_file /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/test_smi_npy/LC50_test_canonical.smi --save_hidden_info_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LC50_test_hidden_info_LC50_finetune.npy --get_hidden_info --get_hidden_info_from_model --extract_features_method average_all --extract_features_from_hidden_info --save_feature_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LC50_test_x_avg_LC50_finetune.npy'

    'python /gpfs/wscgpfs02/chendo11/workspace/matai/fairseq_pro/utils_main.py --load_pretrain --model_name_or_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/ --checkpoint_file checkpoint_best.pt --data_name_or_path /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/finetune_data/toxicity_combine_all_train_valid_for_sentence_fintune/ --target_file /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/test_smi_npy/LC50DM_train_canonical.smi --save_hidden_info_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LC50DM_train_hidden_info_LC50DM_finetune.npy --get_hidden_info --get_hidden_info_from_model --extract_features_method average_all --extract_features_from_hidden_info --save_feature_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LC50DM_train_x_avg_LC50DM_finetune.npy'
    'python /gpfs/wscgpfs02/chendo11/workspace/matai/fairseq_pro/utils_main.py --load_pretrain --model_name_or_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/ --checkpoint_file checkpoint_best.pt --data_name_or_path /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/finetune_data/toxicity_combine_all_train_valid_for_sentence_fintune/ --target_file /gpfs/wscgpfs02/chendo11/workspace/matai/Dataset/test_smi_npy/LC50DM_test_canonical.smi --save_hidden_info_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LC50DM_test_hidden_info_LC50DM_finetune.npy --get_hidden_info --get_hidden_info_from_model --extract_features_method average_all --extract_features_from_hidden_info --save_feature_path /gpfs/wscgpfs01/chendo11/test/avg_from_chembl26all_sentence_finetune/hidden_info_from_sentence_finetune/sentence_finetune_2000_updates/finetune_model_masked015_valid_mask/LC50DM_test_x_avg_LC50DM_finetune.npy'
)


# python test_torch.py --modelid $modelID LD50_test_canonical.smi LD50_train_canonical.smi
${jobneme[$modelID]:0}

